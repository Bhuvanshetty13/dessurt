#!/bin/bash


#SBATCH --time=1:20:00   # walltime
#SBATCH --ntasks=5
#SBATCH --nodes=1
#XXXXXSBATCH --gres=gpu:1
#SBATCH -J "eval FUNSD"
#SBATCH --mem-per-cpu=2048M
#SBATCH --mail-user=herobd@gmail.com   # email address
#SBATCH --mail-type=END
#SBATCH --mail-type=FAIL
#xxxSBATCH -C 'pascal'
#xxxSBATCH --qos=standby   
#xxxSBATCH --requeue

#130:00:00

export PBS_NODEFILE=`/fslapps/fslutils/generate_pbs_nodefile`
export PBS_JOBID=$SLURM_JOB_ID
export PBS_O_WORKDIR="$SLURM_SUBMIT_DIR"
export PBS_QUEUE=batch

export OMP_NUM_THREADS=$SLURM_CPUS_ON_NODE

#Tesseract things
module load libtiff/4.0
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/fslhome/brianld/local/lib
export PATH=$PATH:/fslhome/brianld/local/bin
export TESSDATA_PREFIX=/fslhome/brianld/tesseract/tessdata

#echo "From here on is the output from the program"
#module load python/3.6
module load cuda/10.1
module load cudnn/7.6
#module load pytorch/1.0
#module load opencv/3/2
cd ~/pairing
#source pairing/bin/activate
source deactivate
source activate /fslhome/brianld/miniconda3/envs/new
conda info --envs

#rm -r out/*
#rm -r out2/*
#mkdir out2


echo 'FUN B graph'
python new_eval.py -c saved/FUNSDLines_pair_graph663rvCon4_smallContext_prop_B/checkpoint-latest.pth -v 0 -T -a characterization=1
#echo 'FUNSD B binary'
#python new_eval.py -c saved/FUNSDLines_pair_binary333rv_mc_prop_longer_B/checkpoint-latest.pth -g 0 -v 0 -T 

